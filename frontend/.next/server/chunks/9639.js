"use strict";exports.id=9639,exports.ids=[9639],exports.modules={32450:(a,b,c)=>{c.d(b,{A:()=>f,G:()=>g,R:()=>h,a:()=>i});var d=c(66150),e=c(72291);let f=a=>(0,d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 21 20",...a,children:[(0,d.jsx)("path",{fill:"url(#icloud-gradient)",d:"M12.34 7.315a4.26 4.26 0 0 0-3.707 2.18 2.336 2.336 0 0 0-1.02-.236 2.336 2.336 0 0 0-2.3 1.963 3.217 3.217 0 0 0 1.244 6.181c.135-.001.27-.01.404-.029h8.943c.047.004.094.006.141.007.045-.001.09-.004.135-.007h.214v-.016a2.99 2.99 0 0 0 1.887-.988c.487-.55.757-1.261.757-1.998v-.006a3.017 3.017 0 0 0-.69-1.915 2.992 2.992 0 0 0-1.748-1.034 4.26 4.26 0 0 0-4.26-4.102Z"}),(0,d.jsx)("defs",{children:(0,d.jsxs)("linearGradient",{id:"icloud-gradient",x1:19.086,x2:3.333,y1:14.38,y2:14.163,gradientUnits:"userSpaceOnUse",children:[(0,d.jsx)("stop",{stopColor:"#3E82F4"}),(0,d.jsx)("stop",{offset:1,stopColor:"#93DCF7"})]})})]}),g=({style:a,...b})=>(0,d.jsxs)("svg",{width:"16",height:"14",style:a,viewBox:"0 0 16 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",...b,children:[(0,d.jsxs)("g",{clipPath:"url(#clip0_2115_829)",children:[(0,d.jsx)("path",{d:"M2.34709 12.9404L2.3471 12.9404L2.34565 12.938L1.64031 11.7448L1.64004 11.7444L0.651257 10.0677C0.640723 10.0496 0.630746 10.0314 0.621325 10.0129H4.16461L2.39424 13.0139C2.3775 12.9901 2.36178 12.9656 2.34709 12.9404Z",fill:"#0066DA",stroke:"#6366F1"}),(0,d.jsx)("path",{d:"M8 4.48713L5.47995 0.215332C5.23253 0.358922 5.02176 0.556358 4.87514 0.80764L0.219931 8.70508C0.076007 8.95094 0.000191627 9.22937 0 9.51277H5.04009L8 4.48713Z",fill:"#00AC47"}),(0,d.jsx)("path",{d:"M13.48 13.7847C13.7274 13.6411 13.9382 13.4437 14.0848 13.1924L14.3781 12.6988L15.7801 10.3206C15.9267 10.0693 16.0001 9.79114 16.0001 9.51294H10.9596L12.0321 11.577L13.48 13.7847Z",fill:"#EA4335"}),(0,d.jsx)("path",{d:"M8.00003 4.48718L10.5201 0.215385C10.2726 0.0717949 9.98857 0 9.69533 0H6.30472C6.01148 0 5.7274 0.0807692 5.47998 0.215385L8.00003 4.48718Z",fill:"#00832D"}),(0,d.jsx)("path",{d:"M10.9599 9.51294H5.04007L2.52002 13.7847C2.76744 13.9283 3.05152 14.0001 3.34476 14.0001H12.6552C12.9484 14.0001 13.2325 13.9194 13.4799 13.7847L10.9599 9.51294Z",fill:"#2684FC"}),(0,d.jsx)("path",{d:"M13.4525 4.75636L11.1249 0.80764C10.9782 0.556358 10.7675 0.358922 10.52 0.215332L8 4.48713L10.9599 9.51277H15.9908C15.9908 9.23456 15.9175 8.95636 15.7709 8.70508L13.4525 4.75636Z",fill:"#FFBA00"})]}),(0,d.jsx)("defs",{children:(0,d.jsx)("clipPath",{id:"clip0_2115_829",children:(0,d.jsx)("rect",{width:"16",height:"14",fill:"white"})})})]}),h=e.I4.div`
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding-top: 24px;
  padding-bottom: 24px;
`,i=e.I4.div`
  padding-bottom: 24px;
`},49639:(a,b,c)=>{c.r(b),c.d(b,{RecoveryOAuthScreen:()=>t,default:()=>t});var d=c(66150),e=c(7719),f=c(55164),g=c(94550),h=c(50579),i=c(59962),j=c(67331),k=c(2808),l=c(52650),m=c(8327),n=c(11863),o=c(32450);async function p({url:a,popup:b,provider:c}){return b.location=a,new Promise((a,c)=>{function d(){b?.close(),window.removeEventListener("message",e)}function e(b){b.data&&("PRIVY_OAUTH_RESPONSE"===b.data.type&&b.data.stateCode&&b.data.authorizationCode&&(a(b.data),d()),"https://cdn.apple-cloudkit.com"===b.origin&&b.data.ckSession&&(a({type:"PRIVY_OAUTH_RESPONSE",ckWebAuthToken:b.data.ckSession}),d()),"PRIVY_OAUTH_ERROR"===b.data.type&&(c(b.data.error),d()))}window.addEventListener("message",e)})}async function q({api:a,provider:b,stateCode:c,codeVerifier:d,authorizationCode:e}){if(!e||!c)throw new j.a("[OAuth AuthFlow] Authorization and state codes code must be set prior to calling authenicate.");if("undefined"===e)throw new j.a("User denied confirmation during OAuth flow");try{return(await a.post(l.a8,{authorization_code:e,state_code:c,code_verifier:d,provider:b})).access_token}catch(b){let a=(0,j.f)(b);if(a.privyErrorCode)throw new j.a(a.message||"Invalid code during OAuth flow.",void 0,a.privyErrorCode);if("User denied confirmation during OAuth flow"===a.message)throw new j.a("Invalid code during oauth flow.",void 0,j.b.OAUTH_USER_DENIED);throw new j.a("Invalid code during OAuth flow.",void 0,j.b.UNKNOWN_AUTH_ERROR)}}async function r({api:a,provider:b}){let c=(0,i.o)(),d=(0,i.q)(),e=await (0,i.r)(c);try{return"icloud"===b?{url:(await a.post(l.a9,{client_type:"web"})).url}:{url:(await a.post(l.aa,{redirect_to:window.location.href,code_challenge:e,state_code:d})).url,codeVerifier:c,stateCode:d,provider:b}}catch(a){throw(0,j.f)(a)}}c(11765),c(43132),c(19078),c(30443),c(8752);let s={"google-drive":{name:"Google Drive",component:o.G},icloud:{name:"iCloud",component:o.A}},t={component:()=>{let{logout:a}=(0,k.u)(),{navigate:b,setModalData:c,data:l}=(0,k.a)(),{closePrivyModal:t,createAnalyticsEvent:u}=(0,j.u)(),{execute:v}=(()=>{let{client:a,walletProxy:b,refreshSessionAndUser:c}=(0,j.u)(),{data:d}=(0,k.a)(),{user:e}=(0,k.u)(),f=(0,n.a)(),{create:g}=(0,i.v)();return{execute:async({provider:h,action:i,popup:l,shouldCreateEth:n,shouldCreateSol:o})=>{let s,t;if(!a)throw new j.a("Missing client");function u(b){if(!b&&a)throw a.createAnalyticsEvent({eventName:"recovery_oauth_error",payload:{error:"Unable to open recovery OAuth popup",provider:h}}),new j.a("Recovery OAuth failed")}switch(h){case"google-drive":{let b,c,{url:d,codeVerifier:e,stateCode:f}=await r({api:a.api,provider:h});u(d);try{let e=await p({url:d,popup:l,provider:h});if(b=e.stateCode,c=e.authorizationCode,b!==f)throw a.createAnalyticsEvent({eventName:"possible_phishing_attempt",payload:{provider:h,storedStateCode:f??"",returnedStateCode:b??""}}),new j.a("Unexpected auth flow. This may be a phishing attempt.",void 0,j.b.OAUTH_UNEXPECTED)}catch(b){throw a.createAnalyticsEvent({eventName:"recovery_oauth_error",payload:{error:b.toString(),provider:h}}),new j.a("Recovery OAuth failed")}[s,t]=await Promise.all([a.getAccessToken(),q({api:a.api,provider:h,codeVerifier:e,stateCode:b,authorizationCode:c})]);break}case"icloud":{let{url:b}=await r({api:a.api,provider:h});u(b);let{ckWebAuthToken:c}=await p({url:b,popup:l,provider:h});t=c,s=await a.getAccessToken()}}if(!b)throw new j.a("Cannot connect to wallet proxy");if(!s)throw new j.a("Unable to authorize user");switch(i){case"recover":{let c=d?.recoverWallet?.entropyId,e=d?.recoverWallet?.entropyIdVerifier;if(!c||!e)throw new j.a("Recovery OAuth failed");a.createAnalyticsEvent({eventName:"embedded_wallet_recovery_started",payload:{walletAddress:c,recoveryMethod:h}}),await b.recover({accessToken:s,entropyId:c,entropyIdVerifier:e,recoveryAccessToken:t}),a.createAnalyticsEvent({eventName:"embedded_wallet_recovery_completed",payload:{walletAddress:c,recoveryMethod:h}});break}case"create-wallet":{let b;if(a.createAnalyticsEvent({eventName:"embedded_wallet_creation_started"}),n&&o)b=await g({recoveryMethod:h,recoveryAccessToken:t,chainType:"ethereum",walletIndex:0,latestUser:e}),b=await g({chainType:"solana",walletIndex:0,latestUser:b.user});else if(o)b=await g({recoveryMethod:h,recoveryAccessToken:t,chainType:"solana",walletIndex:0,latestUser:e});else{if(!n)throw Error("Invalid args to create wallet");b=await g({recoveryMethod:h,recoveryAccessToken:t,chainType:"ethereum",walletIndex:0,latestUser:e})}if(!b)throw f("createWallet","onError",j.b.UNKNOWN_EMBEDDED_WALLET_ERROR),Error("Failed to create wallet");a.createAnalyticsEvent({eventName:"embedded_wallet_creation_completed",payload:{walletAddress:b.account.address}}),f("createWallet","onSuccess",{wallet:b.account});break}case"set-recovery":{let d=(0,k.g)(e);if(!d)throw f("setWalletRecovery","onError",j.b.EMBEDDED_WALLET_NOT_FOUND),Error("Embedded wallet not found");a.createAnalyticsEvent({eventName:"embedded_wallet_set_recovery_started",payload:{walletAddress:d.address,existingRecoveryMethod:d.recoveryMethod,targetRecoveryMethod:h}});let{entropyId:g,entropyIdVerifier:i}=(0,m.g)(e);await b.setRecovery({accessToken:s,entropyId:g,entropyIdVerifier:i,recoveryMethod:h,recoveryAccessToken:t});let l=(0,k.g)(await c());if(!l)throw f("createWallet","onError",j.b.UNKNOWN_EMBEDDED_WALLET_ERROR),Error("Failed to set recovery on wallet");a.createAnalyticsEvent({eventName:"embedded_wallet_set_recovery_completed",payload:{walletAddress:d.address,existingRecoveryMethod:d.recoveryMethod,targetRecoveryMethod:h}}),f("setWalletRecovery","onSuccess",{method:h,wallet:l});break}default:throw new j.a("Unsupported recovery action")}}}})(),[w,x]=(0,e.useState)(!1),{provider:y,action:z,isInAccountCreateFlow:A,shouldCreateEth:B,shouldCreateSol:C}=l?.recoveryOAuthStatus,[D,E]=(0,e.useState)(void 0),[F,G]=(0,e.useState)("create-wallet"===z);if("user-passcode"===y)throw Error("RecoveryOAuthScreen should never be called with a wallet that specifies recoveryMethod: `user-passcode`");let H=s[y].name,I=s[y].component,J=l?.recoverWallet?.onCompleteNavigateTo,K=new i.R(async(a="create-wallet")=>(G(!0),new Promise((b,c)=>{setTimeout(async()=>{try{let c=window.open();await v({provider:y,action:a,popup:c,shouldCreateEth:B,shouldCreateSol:C}),x(!0),b()}catch(b){E({message:`${"recover"===a?"Recovery":"Back up"} with ${H} unsuccessful`,detail:"recover"===z?`Please verify that you are selecting the ${H} account associated with your backup.`:"",retryable:!0}),c()}},0)})));(0,e.useEffect)(()=>{"recover"!==z&&K.execute(A?"create-wallet":"set-recovery")},[]),(0,e.useEffect)(()=>{if(!w)return;let d=setTimeout(()=>{A?(c({createWallet:{onSuccess:()=>{},onFailure:b=>{u({eventName:"embedded_wallet_creation_failure_logout",payload:{error:b,screen:"RecoveryOAuthScreen"}}),a()},callAuthOnSuccessOnClose:!0,shouldCreateEth:!1,shouldCreateSol:!1}}),b("EmbeddedWalletCreatedScreen")):t({shouldCallAuthOnSuccess:!1})},h.q);return()=>clearTimeout(d)},[w]);let L=(0,e.useCallback)(async()=>{await K.execute("recover"),J?b(J):x(!0)},[]),M="google-drive"===y?"Google Drive":"Apple iCloud",N=w&&`Successfully ${"recover"===z?"recovered":"backed up"} with ${M}.`||D&&D.message||`${"recover"===z?"Recovering":"Backing up"} with ${M}...`,O=D?D.detail:"";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(f.M,{}),F?(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(o.R,{children:[(0,d.jsx)(g.C,{title:N,icon:(0,d.jsx)(I,{style:{width:"38px",height:"38px"}}),description:O}),D&&D?.retryable?(0,d.jsx)(f.P,{onClick:()=>{(0,i.l)(),E(void 0),"create-wallet"===z?K.execute("create-wallet"):L()},disabled:!w&&!D?.retryable,children:"Try again"}):null]})}):(0,d.jsxs)(o.R,{children:[(0,d.jsx)(g.C,{title:"Confirm it's really you",icon:(0,d.jsx)(I,{style:{height:42,width:48}}),description:`To confirm your identity, please log in to ${M} where your account is backed up.`}),(0,d.jsxs)(f.P,{onClick:L,children:["Confirm with ",M]})]}),(0,d.jsx)(f.B,{})]})}}},94550:(a,b,c)=>{c.d(b,{C:()=>g,S:()=>f});var d=c(66150),e=c(72291);let f=({title:a,description:b,children:c,...e})=>(0,d.jsx)(h,{...e,children:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("h3",{children:a}),"string"==typeof b?(0,d.jsx)("p",{children:b}):b,c]})});(0,e.I4)(f)`
  margin-bottom: 24px;
`;let g=({title:a,description:b,icon:c,children:e,...f})=>(0,d.jsxs)(i,{...f,children:[c||null,(0,d.jsx)("h3",{children:a}),b&&"string"==typeof b?(0,d.jsx)("p",{children:b}):b,e]}),h=e.I4.div`
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: flex-start;
  text-align: left;
  gap: 8px;
  width: 100%;
  margin-bottom: 24px;

  && h3 {
    font-size: 17px;
    color: var(--privy-color-foreground);
  }

  /* Sugar assuming children are paragraphs. Otherwise, handling styling on your own */
  && p {
    color: var(--privy-color-foreground-2);
    font-size: 14px;
  }
`,i=(0,e.I4)(h)`
  align-items: center;
  text-align: center;
  gap: 16px;

  h3 {
    margin-bottom: 24px;
  }
`}};