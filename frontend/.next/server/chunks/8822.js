"use strict";exports.id=8822,exports.ids=[8822],exports.modules={8822:(a,b,c)=>{c.r(b),c.d(b,{AwaitingEvmToSolBridgingScreen:()=>G,default:()=>G});var d=c(66150),e=c(12885),f=c(7719),g=c(5819),h=c(33469),i=c(73029),j=c(9595),k=c(14415),l=c(26497),m=c(59318),n=c(65389),o=c(55164),p=c(94550),q=c(21242),r=c(59656),s=c(50579),t=c(67331),u=c(69712),v=c(2808),w=c(60606),x=c(8327),y=c(92824),z=c(50460),A=c(59962),B=c(75281),C=c(84977),D=c(32482),E=c(38479),F=c(22676);c(19078),c(11765),c(43132),c(30443),c(8752);let G={component:()=>{let a=(0,s.u)(),{rpcConfig:b,appId:c,closePrivyModal:G,createAnalyticsEvent:H}=(0,t.u)(),{navigate:I,setModalData:J,data:K}=(0,v.a)(),L=(0,s.u)(),{wallets:M}=(0,x.u)(),[N,O]=(0,f.useState)(null),[P,Q]=(0,f.useState)(null),[R,S]=(0,f.useState)([]),[T,U]=(0,f.useState)(0),[V,W]=(0,f.useState)(!1),[X,Y]=(0,f.useState)(!1),[Z,$]=(0,f.useState)(!1),[_,aa]=(0,f.useState)(!1),[ab,ac]=(0,f.useState)(),[ad,ae]=(0,f.useState)();if(!K?.funding||"solana"!==K.funding.chainType)throw Error("Invalid funding data");let{address:af,chain:ag,connectedWallet:ah}=K.funding,[ai,aj]=(0,f.useState)(K.funding.amount),ak=("ethereum"===ah?.type?ah:void 0)??M[0],al=(0,u.Q)(ak?.walletClientType||"unknown"),am=al?.name||"wallet",[an,ao]=(0,f.useState)(null);(0,f.useEffect)(()=>{(async()=>{if(!ak)return;let a=await ak.getEthereumProvider();ao((0,g.F)({account:ak.address,transport:(0,h.I)(a)}).extend(i.$))})().catch(console.error)},[ak]);let[ap,aq]=(0,f.useState)(0n),ar=(0,C.g)(ap);(0,f.useEffect)(()=>{let b=a.solanaRpcs[ag];b?(0,A.x)({rpc:b.rpc,address:af}).then(a=>aq(BigInt(a))).catch(console.error):console.warn("Unable to load solana rpc, skipping balance")},[]);let[as,at]=(0,f.useState)(),{tokenPrice:au}=(0,w.u)("solana"),{fundingAmountInBaseUnit:av,fundingAmountInUsd:aw}=(0,C.a)({amount:ai,fee:0n,tokenPrice:au,isUsdc:K.funding.isUSDC});if((0,f.useEffect)(()=>{(async()=>{if(!an||!ak)return;let a=["solana:testnet","solana:devnet"].includes(ag);a&&console.warn("Solana testnets are not supported for bridging");let d=(0,m.u)(L.chains).filter(({testnet:b})=>!!b===a),e=(await (0,D.g)({chains:d,address:ak.address,appId:c,rpcConfig:b})).filter(a=>a.balance>0n);if(e.length<1)return void O(new t.a(`Wallet ${(0,u.D)(ak.address)} does not have enough funds.`,void 0,t.b.INSUFFICIENT_BALANCE));e.sort((a,b)=>Number(b.balance-a.balance));let f=(await Promise.allSettled(e.map(async a=>({...a,quote:await (0,z.g)({isTestnet:!1,input:(0,z.t)({appId:c,amount:av.toString(),user:ak.address,recipient:af,destinationChainId:z.b,destinationCurrency:z.a,originChainId:a.chain.id})})})))).filter(a=>"fulfilled"===a.status).map(a=>a.value);if(f.length<1)return void O(new t.a(`Unable to fetch quotes for bridging. Wallet ${(0,u.D)(ak.address)} does not have enough funds.`,void 0,t.b.INSUFFICIENT_BALANCE));let g=f.map(({quote:a,balance:b,chain:c})=>({bridgeTx:(0,z.c)(a),balance:b,chain:c,isErc20Quote:!1})).filter(({bridgeTx:a})=>!!a);if(g.length>1)return void S(g);let h=g.at(0);h?(Y(!0),at({data:h.bridgeTx.data,to:h.bridgeTx.to,value:h.bridgeTx.value,chain:h.chain})):O(new t.a(`Unable to select bridge option from quotes. Wallet ${(0,u.D)(ak.address)} does not have enough funds.`,void 0,t.b.INSUFFICIENT_BALANCE))})().catch(console.error)},[an]),(0,f.useEffect)(()=>{(async()=>{let a,d;if(!an||!ak||V||Z||!as)return;W(!0);let e=(0,j.l)({chain:as.chain,transport:(0,k.L)((0,E.a)(as.chain,b,c))});try{a=await e.prepareTransactionRequest({account:ak.address,to:as.to,chain:as.chain,data:as.data,value:BigInt(as.value??0)})}catch(a){console.error(a),R.length>1&&Q(a.shortMessage??"Something went wrong")}if(a){W(!1),$(!0);try{await an.switchChain({id:as.chain.id})}catch(a){await an.addChain({chain:as.chain}),await an.switchChain({id:as.chain.id})}try{d=await an.sendTransaction(a)}catch(a){console.error(a),"TransactionExecutionError"===a.name&&(R.length<1?O(new t.a(a.shortMessage,void 0,t.b.TRANSACTION_FAILURE)):Q(a.shortMessage??"Something went wrong"))}if(d)return await an.waitForTransactionReceipt({hash:d}),X?(ae("pending"),void ac(d)):($(!1),aa(!0),void H({eventName:y.O,payload:{provider:"external",status:"success",txHash:d,address:ak.address,chainId:as.chain.id,chainType:"ethereum",value:as.value?(0,l.J)(BigInt(as.value),18):void 0,token:"ETH",destination:af,destinationClusterName:"mainnet-beta",destinationChainType:"solana",destinationValue:(0,l.J)(av,9),destinationToken:"SOL"}}));$(!1)}else W(!1)})().catch(console.error)},[an,as]),(0,z.u)({transactionHash:ab,isTestnet:!1,bridgingStatus:ad,setBridgingStatus:ae,onSuccess({transactionHash:a}){Y(!1),aa(!0),H({eventName:y.O,payload:{provider:"external",status:"success",txHash:a,address:ak?.address,chainId:as?.chain.id,chainType:"ethereum",value:as?.value?(0,l.J)(BigInt(as.value),18):void 0,token:"ETH",destination:af,destinationClusterName:"mainnet-beta",destinationChainType:"solana",destinationValue:(0,l.J)(av,9),destinationToken:"SOL"}})},onFailure({error:a}){Y(!1),O(a)}}),(0,f.useEffect)(()=>{N&&(J({funding:K?.funding,solanaFundingData:K?.solanaFundingData,sendTransaction:K?.sendTransaction,errorModalData:{error:N,previousScreen:"TransferFromWalletScreen"}}),I("ErrorScreen",!1))},[N]),(0,f.useEffect)(()=>{if(!_)return;let a=setTimeout(G,s.t);return()=>clearTimeout(a)},[_]),_)return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(q.t,{}),(0,d.jsx)(n.b,{}),(0,d.jsxs)(n.c,{children:[(0,d.jsx)(e.A,{color:"var(--privy-color-success)",width:"64px",height:"64px"}),(0,d.jsx)(p.C,{title:"Success!",description:`Youâ€™ve successfully added ${ai} SOL to your ${L.name} wallet. It may take a minute before the funds are available to use.`})]}),(0,d.jsx)(n.R,{}),(0,d.jsx)(o.B,{})]});let ax=R[T];return R.length>1&&ax?(0,d.jsx)(D.B,{displayName:am,configuredFundingChain:ag,formattedBalance:ar,fundingAmount:ai,fundingCurrency:"SOL",fundingAmountInUsd:aw,options:R,selectedOption:ax,isPreparing:V,isSubmitting:Z,addressToFund:af,fundingWalletAddress:ak?.address||"",errorMessage:P,onSubmit:()=>{K.funding?.amount!==ai?(async function(){if(ak&&ax)try{let a=await (0,z.g)({isTestnet:!1,input:(0,z.t)({appId:c,amount:av.toString(),user:ak.address,recipient:af,destinationChainId:z.b,destinationCurrency:z.a,originChainId:ax.chain.id})}),b=(0,z.c)(a);if(!b)throw Error("Invalid transaction request");Y(!0),at({data:b.data,to:b.to,value:b.value,chain:ax.chain})}catch(a){console.error(a),O(new t.a("Unable to fetch quotes for bridging",a,t.b.INSUFFICIENT_BALANCE))}})().catch(console.error):at({to:ax.bridgeTx.to,data:ax.bridgeTx.data,value:ax.bridgeTx.value,chain:ax.chain})},onSelect:a=>{a!==T&&(Q(null),U(a))},onAmountChange:aj}):Z&&ak?(0,d.jsx)(F.T,{walletClientType:ak?.walletClientType||"unknown",displayName:am,addressToFund:af,isBridging:X,isErc20Flow:!1,chainId:"solana",chainName:(0,B.g)(ag),totalPriceInUsd:void 0,totalPriceInNativeCurrency:void 0,gasPriceInUsd:void 0,gasPriceInNativeCurrency:void 0}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(q.t,{}),(0,d.jsx)(r.N,{}),(0,d.jsx)("div",{style:{marginTop:"1rem"}}),(0,d.jsx)(o.B,{})]})}}},64003:(a,b,c)=>{c.d(b,{A:()=>h,D:()=>k,J:()=>j,L:()=>d,R:()=>i,S:()=>e,T:()=>f,a:()=>g,g:()=>l});let d=1e9,e="11111111111111111111111111111111",f="TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",g="TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb",h="ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",i=["CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C","CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"],j=["JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4"],k={"solana:mainnet":{EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v:{symbol:"USDC",decimals:6,address:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"},Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB:{symbol:"USDT",decimals:6,address:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"},So11111111111111111111111111111111111111112:{symbol:"SOL",decimals:9,address:"So11111111111111111111111111111111111111112"}},"solana:devnet":{"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU":{symbol:"USDC",decimals:6,address:"4zMMC9srt5Ri5X14GAgXhaHii3GnPAEERYPJgZJDncDU"},EJwZgeZrdC8TXTQbQBoL6bfuAnFUUy1PVCMB4DYPzVaS:{symbol:"USDT",decimals:6,address:"EJwZgeZrdC8TXTQbQBoL6bfuAnFUUy1PVCMB4DYPzVaS"},So11111111111111111111111111111111111111112:{symbol:"SOL",decimals:9,address:"So11111111111111111111111111111111111111112"}},"solana:testnet":{}};function l(a,b){let c=parseFloat(a.toString())/d,e=m.format(b*c);return"$0.00"===e?"<$0.01":e}let m=new Intl.NumberFormat(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2})},84977:(a,b,c)=>{c.d(b,{a:()=>f,g:()=>e});var d=c(64003);function e(a,b=6,c=!1,d=!1){let f=(parseFloat(a.toString())/1e9).toFixed(b).replace(/0+$/,"").replace(/\.$/,""),g=d?"":" SOL";return c?`${f}${g}`:`${"0"===f?"<0.001":f}${g}`}function f({amount:a,fee:b,tokenPrice:c,isUsdc:f}){let g=BigInt(Math.floor(parseFloat(a)*10**(f?6:9))),h=f?g:g+b;return{fundingAmountInBaseUnit:g,fundingAmountInUsd:c?(0,d.g)(g,c):void 0,totalPriceInUsd:c?(0,d.g)(h,c):void 0,totalPriceInNativeCurrency:e(h),feePriceInNativeCurrency:e(b),feePriceInUsd:c?(0,d.g)(b,c):void 0}}}};