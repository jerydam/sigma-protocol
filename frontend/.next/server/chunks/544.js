"use strict";exports.id=544,exports.ids=[544],exports.modules={20927:(a,b,c)=>{c.d(b,{E:()=>d,a:()=>e});let d=[{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],e=[{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}]},36570:(a,b,c)=>{c.d(b,{g:()=>f});var d=c(1236),e=c(61650);function f(a,b="wei"){return(0,e.X)(a,d.eL[b])}},61650:(a,b,c)=>{c.d(b,{X:()=>f});var d=c(63696);class e extends d.C{constructor({value:a}){super(`Number \`${a}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function f(a,b){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(a))throw new e({value:a});let[c,d="0"]=a.split("."),f=c.startsWith("-");if(f&&(c=c.slice(1)),d=d.replace(/(0+)$/,""),0===b)1===Math.round(Number(`.${d}`))&&(c=`${BigInt(c)+1n}`),d="";else if(d.length>b){let[a,e,f]=[d.slice(0,b-1),d.slice(b-1,b),d.slice(b)],g=Math.round(Number(`${e}.${f}`));(d=g>9?`${BigInt(a)+BigInt(1)}0`.padStart(a.length+1,"0"):`${a}${g}`).length>b&&(d=d.slice(1),c=`${BigInt(c)+1n}`),d=d.slice(0,b)}else d=d.padEnd(b,"0");return BigInt(`${f?"-":""}${c}${d}`)}},90544:(a,b,c)=>{c.r(b),c.d(b,{AwaitingExternalEthereumTransferScreen:()=>K,default:()=>K});var d=c(66150),e=c(12885),f=c(7719),g=c(36570),h=c(5819),i=c(33469),j=c(73029),k=c(9595),l=c(14415),m=c(97281),n=c(26497),o=c(59318),p=c(65389),q=c(55164),r=c(94550),s=c(21242),t=c(59656),u=c(50579),v=c(67331),w=c(69712),x=c(2808),y=c(60606),z=c(8327),A=c(20927),B=c(20365),C=c(78624),D=c(92824),E=c(50460),F=c(59962),G=c(32482),H=c(53230),I=c(38479),J=c(22676);c(19078),c(11765),c(43132),c(30443),c(8752);let K={component:()=>{let{rpcConfig:a,appId:b,closePrivyModal:c,createAnalyticsEvent:K}=(0,v.u)(),{navigate:L,setModalData:M,data:N}=(0,x.a)(),O=(0,u.u)(),{wallets:P}=(0,z.u)(),[Q,R]=(0,f.useState)(!1),[S,T]=(0,f.useState)(0n),[U,V]=(0,f.useState)(!1),[W,X]=(0,f.useState)(null),[Y,Z]=(0,f.useState)(null),[$,_]=(0,f.useState)([]),[aa,ab]=(0,f.useState)(0),[ac,ad]=(0,f.useState)(!1),[ae,af]=(0,f.useState)(!1),[ag,ah]=(0,f.useState)(!1),[ai,aj]=(0,f.useState)(!1),[ak,al]=(0,f.useState)(),[am,an]=(0,f.useState)();if(!N?.funding||"ethereum"!==N.funding.chainType)throw Error("Invalid funding data");let{erc20ContractInfo:ao,chain:ap,connectedWallet:aq}=N.funding,ar=N.funding.address,as=N.funding.erc20Address,[at,au]=(0,f.useState)(N.funding.amount);(0,f.useEffect)(()=>{as&&!ao&&X(Error("Unable to fetch token details"))},[]);let av=!!as&&!!ao,aw=av?BigInt(parseFloat(at)*10**ao.decimals):(0,g.g)(at),ax=("ethereum"===aq?.type?aq:void 0)??P[0],ay=(0,w.Q)(ax?.walletClientType||"unknown"),az=ay?.name||"wallet",[aA,aB]=(0,f.useState)(null);(0,f.useEffect)(()=>{(async()=>{if(!ax)return;let a=await ax.getEthereumProvider();aB((0,h.F)({account:ax.address,transport:(0,i.I)(a)}).extend(j.$))})().catch(console.error)},[ax]);let[aC,aD]=(0,f.useState)(0n);(0,f.useEffect)(()=>{(0,k.l)({chain:ap,transport:(0,l.L)((0,I.a)(ap,a,b))}).getBalance({address:ar}).then(aD).catch(console.error)},[]);let[aE,aF]=(0,f.useState)(0n);(0,f.useEffect)(()=>{av&&(0,H.g)({chain:ap,address:ar,appId:b,rpcConfig:a,erc20Address:as}).then(a=>aF(a.balance)).catch(console.error)},[]);let{tokenPrice:aG}=(0,y.u)(ap.id),[aH,aI]=(0,f.useState)({to:ar,chain:ap,value:aw,data:void 0});(0,f.useEffect)(()=>{(async()=>{let c,d;if(!aA||!ax||ac||ag)return;ad(!0);let e=(0,k.l)({chain:aH.chain,transport:(0,l.L)((0,I.a)(aH.chain,a,b))});if(av&&!aH.data)return await e.simulateContract({address:as,chain:aH.chain,abi:A.E,functionName:"transfer",args:[ar,aw],account:ax.address}).catch(a=>{if("ContractFunctionZeroDataError"===a?.cause?.name||a?.message?.includes("returned no data"))return e.simulateContract({address:as,chain:aH.chain,abi:A.a,functionName:"transfer",args:[ar,aw],account:ax.address}).catch(a=>{console.warn("Simulated token transfer failed with error, fetching bridge options.",a)});console.warn("Simulated token transfer failed with error, fetching bridge options.",a)})?(ad(!1),void aI({to:as,chain:aH.chain,data:(0,m.p)({abi:A.E,functionName:"transfer",args:[ar,aw]}),value:"0x0"})):(ad(!1),void V(!0));try{c=await e.prepareTransactionRequest({account:ax.address,to:aH.to,chain:aH.chain,data:aH.data,value:BigInt(aH.value??0)})}catch(a){if(console.error(a),$.length>1)Z(a.shortMessage??"Something went wrong");else if(ae&&0===$.length)return void X(new v.a(`Wallet ${(0,w.D)(ax.address)} does not have enough funds.`,void 0,v.b.INSUFFICIENT_BALANCE))}if(!c)return ad(!1),void V(!0);ad(!1),ah(!0),R(!0),T(c.gas);try{await aA.switchChain({id:aH.chain.id})}catch(a){await aA.addChain({chain:aH.chain}),await aA.switchChain({id:aH.chain.id})}try{d=await aA.sendTransaction(c)}catch(a){if(console.error(a),"TransactionExecutionError"===a.name)if($.length<1){let b=a.shortMessage;(a.shortMessage.includes("rejected the request")||a.details.includes("rejected the request"))&&(b="User rejected the request."),X(new v.a(b,void 0,v.b.TRANSACTION_FAILURE))}else Z(a.shortMessage??"Something went wrong")}d?(await aA.waitForTransactionReceipt({hash:d}),ah(!1),ae?(al(d),an("pending")):(aj(!0),M((0,F.y)(N,"completed",d,ax?.walletClientType,av,ao,ap)),K({eventName:D.O,payload:{provider:"external",status:"success",txHash:d,address:ax.address,chainId:aH.chain.id,chainType:"ethereum",value:aH.value?(0,n.J)(BigInt(aH.value),ao?.decimals??18):void 0,token:ao?.symbol??as??"ETH",destinationAddress:ar,destinationChainId:ap.id,destinationChainType:"ethereum",destinationValue:aw?(0,n.J)(aw,ao?.decimals??18):void 0,destinationToken:ao?.symbol??as??ap.nativeCurrency.name}}))):ah(!1)})().catch(console.error)},[aA,aH]),(0,f.useEffect)(()=>{(async()=>{if(!U||!aA||!ax)return;let c=(0,o.u)(O.chains).filter(a=>a.id!==ap.id&&!!a.testnet==!!ap.testnet);av&&c.unshift(ap);let d=await (0,G.g)({chains:c,address:ax.address,appId:b,rpcConfig:a,includeUsdc:N.funding?.isUSDC}),e=av?d.filter(a=>a.balance>0n):d.filter(a=>a.balance>aw),f=av&&d.every(a=>0n===a.balance);if(e.length<1)return void X(new v.a(f?`Wallet ${(0,w.D)(ax.address)} doesn't have enough funds to cover gas fees. Top up your wallet and try again.`:`Wallet ${(0,w.D)(ax.address)} does not have enough funds.`,void 0,v.b.INSUFFICIENT_BALANCE));e.sort((a,b)=>Number(av?(b.erc20Balance??0n)-(a.erc20Balance??0n):b.balance-a.balance));let g=e.flatMap(a=>{let c=[{...a,isErc20Quote:!1,isTestnet:!!ap.testnet,input:(0,E.t)({appId:b,amount:aw.toString(),user:ax.address,recipient:ar,destinationChainId:ap.id,destinationCurrency:as,originChainId:a.chain.id})}];return av&&as&&(a.erc20Balance??0n)>=aw&&c.push({...a,isErc20Quote:!0,isTestnet:!!ap.testnet,input:(0,E.t)({appId:b,amount:aw.toString(),user:ax.address,recipient:ar,destinationChainId:ap.id,destinationCurrency:as,originChainId:a.chain.id,originCurrency:a.erc20Address})}),c}),h=(await Promise.allSettled(g.map(async a=>({...a,quote:await (0,E.g)(a)})))).filter(a=>"fulfilled"===a.status).map(a=>a.value);if(h.length<1)return void X(new v.a(`Wallet ${(0,w.D)(ax.address)} does not have enough funds.`,void 0,v.b.INSUFFICIENT_BALANCE));let i=h.map(a=>({bridgeTx:(0,E.c)(a.quote),balance:a.balance,chain:a.chain,erc20Balance:a.erc20Balance,isErc20Quote:a.isErc20Quote})).filter(a=>!!a.bridgeTx);if(i.length>1)return void _(i);let j=i[0];j?(af(!0),aI({data:j.bridgeTx.data,to:j.bridgeTx.to,value:j.bridgeTx.value,chain:j.chain})):X(new v.a(`Wallet ${(0,w.D)(ax.address)} does not have enough funds.`,void 0,v.b.INSUFFICIENT_BALANCE))})().catch(console.error)},[U]),(0,E.u)({transactionHash:ak,isTestnet:!!ap.testnet,bridgingStatus:am,setBridgingStatus:an,onSuccess({transactionHash:a}){af(!1),aj(!0),M((0,F.y)(N,"completed",a,ax?.walletClientType,av,ao,ap)),K({eventName:D.O,payload:{provider:"external",status:"success",txHash:a,address:ax?.address,chainId:aH.chain.id,chainType:"ethereum",value:aH.value?(0,n.J)(BigInt(aH.value),ao?.decimals??18):void 0,token:ao?.symbol??as??"ETH",destinationAddress:ar,destinationChainId:ap.id,destinationChainType:"ethereum",destinationValue:aw?(0,n.J)(aw,ao?.decimals??18):void 0,destinationToken:ao?.symbol??as??ap.nativeCurrency.name}})},onFailure({error:a}){af(!1),X(a)}}),(0,f.useEffect)(()=>{W&&(M({funding:N?.funding,solanaFundingData:N?.solanaFundingData,sendTransaction:N?.sendTransaction,errorModalData:{error:W,previousScreen:"TransferFromWalletScreen"}}),L("ErrorScreen",!1))},[W]);let aJ=!av&&aG?(0,C.c)(at??"0",aG):void 0,aK=av?S:(0,C.s)([S,aw]),aL=aK&&aG?(0,C.a)(aK,aG):void 0,aM=aK?(0,C.g)(aK,N?.funding?.erc20Address?N?.funding?.erc20ContractInfo?.symbol||"ETH":N?.funding?.chain.nativeCurrency.symbol||"ETH"):void 0,aN=S&&aG?(0,C.a)(S,aG):void 0,aO=S?(0,C.g)(S,ap?.nativeCurrency?.symbol||"ETH"):void 0;if((0,f.useEffect)(()=>{if(!ai)return;let a=setTimeout(c,u.t);return()=>clearTimeout(a)},[ai]),ai)return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.t,{}),(0,d.jsx)(p.b,{}),(0,d.jsxs)(p.c,{children:[(0,d.jsx)(e.A,{color:"var(--privy-color-success)",width:"64px",height:"64px"}),(0,d.jsx)(r.C,{title:"Success!",description:`Youâ€™ve successfully added ${at} ${av?ao.symbol:ap.nativeCurrency.symbol} to your ${O.name} wallet. It may take a minute before the funds are available to use.`})]}),(0,d.jsx)(p.R,{}),(0,d.jsx)(q.B,{})]});let aP=av?`${(0,B.f)({amount:aE,decimals:ao.decimals})}  ${ao.symbol}`:(0,C.g)(aC,ap.nativeCurrency.symbol,3,!0),aQ=$[aa];return $.length>1&&aQ?(0,d.jsx)(G.B,{displayName:az,configuredFundingChain:ap,erc20ContractInfo:ao,formattedBalance:aP,fundingAmount:at,fundingCurrency:av?ao.symbol:ap.nativeCurrency.symbol,fundingAmountInUsd:aJ,options:$,selectedOption:aQ,isPreparing:ac,isSubmitting:ag,addressToFund:ar,fundingWalletAddress:ax?.address||"",errorMessage:Y,onSubmit:()=>{N.funding?.amount!==at?(async function(){if(ax&&aQ)try{let a=await (0,E.g)({isTestnet:!!ap.testnet,input:(0,E.t)({appId:b,amount:aw.toString(),user:ax.address,recipient:ar,destinationChainId:ap.id,destinationCurrency:as,originChainId:aQ.chain.id})}),c=(0,E.c)(a);if(!c)throw Error("Invalid transaction request");af(!0),aI({data:c.data,to:c.to,value:c.value,chain:aQ.chain})}catch(a){console.error(a),X(new v.a("Unable to fetch quotes for bridging",a,v.b.INSUFFICIENT_BALANCE))}})().catch(console.error):aI({to:aQ.bridgeTx.to,data:aQ.bridgeTx.data,value:aQ.bridgeTx.value,chain:aQ.chain})},onSelect:a=>{a!==aa&&(Z(null),ab(a))},onAmountChange:au}):Q&&S&&ax&&N?.funding?(0,d.jsx)(J.T,{walletClientType:ax?.walletClientType||"unknown",displayName:az,addressToFund:ar,isBridging:ae,isErc20Flow:av,totalPriceInUsd:aL,totalPriceInNativeCurrency:aM,gasPriceInUsd:aN,gasPriceInNativeCurrency:aO,chainId:ap.id,chainName:ap.name}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.t,{}),(0,d.jsx)(t.N,{}),(0,d.jsx)("div",{style:{marginTop:"1rem"}}),(0,d.jsx)(q.B,{})]})}}}};