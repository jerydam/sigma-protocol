"use strict";exports.id=5278,exports.ids=[5278],exports.modules={12885:(a,b,c)=>{c.d(b,{A:()=>e});var d=c(7719);let e=d.forwardRef(function({title:a,titleId:b,...c},e){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:e,"aria-labelledby":b},c),a?d.createElement("title",{id:b},a):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})},85278:(a,b,c)=>{c.r(b),c.d(b,{MfaEnrollmentFlowScreen:()=>x,default:()=>x});var d=c(66150),e=c(73166),f=c(87394),g=c(7719);let h=g.forwardRef(function({title:a,titleId:b,...c},d){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?g.createElement("title",{id:b},a):null,g.createElement("path",{fillRule:"evenodd",d:"M8.603 3.799A4.49 4.49 0 0 1 12 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 0 1 3.498 1.307 4.491 4.491 0 0 1 1.307 3.497A4.49 4.49 0 0 1 21.75 12a4.49 4.49 0 0 1-1.549 3.397 4.491 4.491 0 0 1-1.307 3.497 4.491 4.491 0 0 1-3.497 1.307A4.49 4.49 0 0 1 12 21.75a4.49 4.49 0 0 1-3.397-1.549 4.49 4.49 0 0 1-3.498-1.306 4.491 4.491 0 0 1-1.307-3.498A4.49 4.49 0 0 1 2.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 0 1 1.307-3.497 4.49 4.49 0 0 1 3.497-1.307Zm7.007 6.387a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}),i=g.forwardRef(function({title:a,titleId:b,...c},d){return g.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":b},c),a?g.createElement("title",{id:b},a):null,g.createElement("path",{fillRule:"evenodd",d:"M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z",clipRule:"evenodd"}))});var j=c(55164),k=c(69712),l=c(50579),m=c(67331),n=c(2808),o=c(59962),p=c(12883),q=c(12885),r=c(75541),s=c(19165),t=c(60279),u=c(7590),v=c(3029);c(11765),c(43132),c(19078),c(30443),c(8752),c(91817);let w=({appName:a,onComplete:b,onReset:c,onClose:e})=>{let[f,h]=(0,g.useState)(""),[i,k]=(0,g.useState)(!1),[m,p]=(0,g.useState)(null),[w,x]=(0,g.useState)("enroll"),{initEnrollmentWithSms:y,submitEnrollmentWithSms:z}=(0,o.d)(),{data:A}=(0,n.a)(),B=(0,l.u)();function C(){A?.mfaEnrollmentFlow?.onSuccess(),b()}return m?(0,d.jsx)(v.ErrorScreenView,{allowlistConfig:B.allowlistConfig,error:m,onBack:()=>p(null),onRetry:()=>p(null)}):(0,d.jsxs)(d.Fragment,"enroll"===w?{children:[(0,d.jsx)(j.M,{backFn:c,onClose:e},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(r.A,{})}),(0,d.jsx)(u.T,{children:"Set up SMS verification"}),(0,d.jsxs)(u.S,{children:["We'll text a verification code to this mobile device whenever you use your ",a," ","wallet."]}),(0,d.jsxs)(u.C,{children:[(0,d.jsx)(t.C,{onSubmit:async function({qualifiedPhoneNumber:a}){try{await y({phoneNumber:a}),h(a),x("verify")}catch(a){p(a)}},hideRecent:!0}),(0,d.jsxs)(u.a,{children:["By providing your mobile number, you agree to receive text messages from ",B?.name,". Some carrier charges may apply"]})]}),(0,d.jsx)(j.b,{})]}:i?{children:[(0,d.jsx)(j.M,{onClose:C},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(q.A,{})}),(0,d.jsx)(u.T,{children:"SMS verification added"}),(0,d.jsxs)(u.S,{children:["From now on, you'll enter the verification code sent to your mobile device whenever you use your ",a," wallet."]}),(0,d.jsx)(u.B,{children:(0,d.jsx)(j.P,{onClick:C,children:"Done"})}),(0,d.jsx)(j.b,{})]}:{children:[(0,d.jsx)(j.M,{backFn:function(){"verify"===w?x("enroll"):c()},onClose:e},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(r.A,{})}),(0,d.jsx)(u.T,{children:"Enter enrollment code"}),(0,d.jsxs)(u.C,{children:[(0,d.jsx)(u.N,{onChange:async function(a){try{if(!a)return;await z({phoneNumber:f,mfaCode:a}),k(!0)}catch(a){if((0,o.f)(a))throw Error("You have exceeded the maximum number of attempts. Please close this window and try again in 10 seconds.");if((0,o.g)(a))throw Error("The code you entered is not valid");if((0,o.h)(a))throw Error("You have exceeded the time limit for code entry. Please try again in 30 seconds.");throw(0,o.i)(a)?Error("Verification canceled"):Error("Unknown error")}}}),(0,d.jsxs)(u.S,{children:["To continue, enter the 6-digit code sent to ",(0,d.jsx)("strong",{children:(0,s.Ds)(f)})]})]}),(0,d.jsx)(j.b,{})]})},x={component:()=>{let{user:a,enrollInMfa:b,ready:c}=(0,n.u)(),[q,r]=(0,g.useState)(null),{unenrollWithSms:s,unenrollWithTotp:t,unenrollWithPasskey:v,submitEnrollmentWithTotp:x,initEnrollmentWithPasskey:y,submitEnrollmentWithPasskey:z,initEnrollmentWithTotp:A}=(0,o.d)(),{data:B,onUserCloseViaDialogOrKeybindRef:C}=(0,n.a)(),D=(0,l.u)(),{closePrivyModal:E}=(0,m.u)(),{promptMfa:F}=(0,o.u)(),[G,H]=(0,g.useState)(!1),[I,J]=(0,g.useState)(null),[K,L]=(0,g.useState)(null),M=()=>{E({shouldCallAuthOnSuccess:!0}),b(!1),setTimeout(()=>{r(null),J(null)},500)},[N,O]=(0,g.useState)(!1),[P,Q]=(0,g.useState)();C.current=M;let R=a?.mfaMethods.includes("sms"),S=!!a?.phone,T=a?.mfaMethods.includes("totp"),U=a?.mfaMethods.includes("passkey"),V=R||T||U,W=a?.linkedAccounts.filter(a=>"passkey"===a.type).map(a=>a.credentialId)??[];function X(){r(null),J(null)}async function Y(a=W){O(!0);try{return await y(),await z({credentialIds:a},{removeForLogin:B?.mfaEnrollmentFlow?.shouldUnlinkOnUnenrollMfa}),B?.mfaEnrollmentFlow?.onSuccess(),M()}catch(a){Q(a)}finally{O(!1)}}if((0,g.useEffect)(()=>{V&&H(!0)},[V]),!c||!a||!D)return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.M,{onClose:M},"header"),(0,d.jsx)(u.A,{children:(0,d.jsx)(p.M,{})}),(0,d.jsx)(u.C,{children:(0,d.jsx)(k.L,{})}),(0,d.jsx)(j.b,{})]});if("sms"===q)return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.M,{backFn:X,onClose:M},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(e.A,{})}),(0,d.jsx)(u.T,{children:"Remove SMS verification?"}),(0,d.jsxs)(u.S,{children:["MFA adds an extra layer of security to your ",D?.name," account. Make sure you have other methods to secure your account."]}),(0,d.jsx)(u.B,{children:(0,d.jsx)(j.P,{$warn:!0,onClick:async function(){r(null);try{await s()}catch(a){r(null)}},children:"Remove"})}),(0,d.jsx)(j.b,{})]});if("totp"===q)return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.M,{backFn:X,onClose:M},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(e.A,{})}),(0,d.jsx)(u.T,{children:"Remove authenticator app verification?"}),(0,d.jsxs)(u.S,{children:["MFA adds an extra layer of security to your ",D?.name," account. Make sure you have other methods to secure your account."]}),(0,d.jsx)(u.B,{children:(0,d.jsx)(j.P,{$warn:!0,onClick:async function(){r(null);try{await t()}catch(a){r(null)}},children:"Remove"})}),(0,d.jsx)(j.b,{})]});if("passkey"===q){let a=B?.mfaEnrollmentFlow?.shouldUnlinkOnUnenrollMfa??!0;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.M,{backFn:X,onClose:M},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(e.A,{})}),(0,d.jsx)(u.T,{children:"Are you sure you want to remove this passkey?"}),(0,d.jsx)(u.S,{children:a?"Removing your passkey will remove as both a verification method and a login method.":"Removing your passkey will remove as a verification method."}),(0,d.jsx)(u.B,{children:(0,d.jsx)(j.P,{$warn:!0,onClick:async function(){r(null);try{await v({removeForLogin:B?.mfaEnrollmentFlow?.shouldUnlinkOnUnenrollMfa})}catch(a){r(null)}},children:"Remove"})}),(0,d.jsx)(j.b,{})]})}if(0===B.mfaEnrollmentFlow.mfaMethods.length&&!V)return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.M,{onClose:M},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(f.A,{})}),(0,d.jsx)(u.T,{children:"Add more security"}),(0,d.jsxs)(u.S,{children:[D?.name," does not have any verification methods enabled."]}),(0,d.jsx)(u.B,{children:(0,d.jsx)(j.P,{onClick:M,children:"Close"})}),(0,d.jsx)(j.b,{})]});let Z=!V&&!G;return Z?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(j.M,{onClose:M},"header"),(0,d.jsx)(u.I,{style:{marginBottom:"1.5rem"},children:(0,d.jsx)(f.A,{})}),(0,d.jsx)(u.T,{children:"Transaction Protection"}),(0,d.jsx)(u.S,{children:"Set up transaction protection to add an extra layer of security to your account"}),(0,d.jsxs)(u.L,{children:[(0,d.jsxs)(u.b,{children:[(0,d.jsx)(u.c,{children:(0,d.jsx)(h,{})}),"Enable 2-Step verification for your ",D?.name," wallet."]}),(0,d.jsxs)(u.b,{children:[(0,d.jsx)(u.c,{children:(0,d.jsx)(i,{})}),"You'll be prompted to authenticate to complete transactions."]})]}),(0,d.jsxs)(u.B,{children:[(0,d.jsx)(j.P,{onClick:()=>H(!0),children:"Continue"}),(0,d.jsx)(j.S,{onClick:M,children:"Not now"})]}),(0,d.jsx)(j.b,{})]}):"sms"===I?(0,d.jsx)(w,{appName:D?.name||"Privy",onComplete:M,onReset:X,onClose:M}):"totp"===I&&K?(0,d.jsx)(p.E,{onClose:M,onReset:X,submitEnrollmentWithTotp:({mfaCode:a})=>(async function(a){try{return Q(void 0),await x({mfaCode:a}),B?.mfaEnrollmentFlow?.onSuccess(),M()}catch(a){Q(a)}finally{r(null)}})(a),totpInfo:{...K,appName:D?.name||"Privy"}}):"passkey"===I?(0,d.jsx)(p.a,{onReset:X,onClose:M,submitEnrollmentWithPasskey:Y}):(0,d.jsx)(p.b,{showIntro:Z,userMfaMethods:a.mfaMethods,appMfaMethods:D.mfa.methods,userHasAuthSms:S,backFn:function(){H(!1)},handleSelectMethod:async function(a){try{await F()}catch(a){return void Q(a)}return"totp"===a?(J(a),L(null),void A().then(a=>{L(a)}).catch(()=>{L(null),X()})):"passkey"===a&&1===W.length?await Y():void J(a)},isTotpLoading:"totp"===I&&!K,isPasskeyLoading:N,error:P,onClose:M,setRemovingMfaMethod:async a=>{try{await F()}catch(a){return void Q(a)}r(a)}})}}}};